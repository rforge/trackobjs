<html><head><title>Rebuild database information for tracked objects</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>track.rebuild(trackObjs)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   track.rebuild">
<param name="keyword" value=" Rebuild database information for tracked objects">
</object>


<h2>Rebuild database information for tracked objects</h2>


<h3>Description</h3>

<p>
Rebuild database information (the file map, and/or the object summary)
for objects in an active tracking environment, or for saved objects
in a tracking directory.
</p>


<h3>Usage</h3>

<pre>
track.rebuild(pos = 1, envir = as.environment(pos), dir = NULL,
        fix = FALSE, level=c("missing", "all"), trust=c("unspecified", "environment", "db"),
        verbose=1, RDataSuffix=NULL, dry.run=TRUE, replace.wd=TRUE,
        use.file.times=TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>pos</code></td>
<td>
The position of the environment to which the tracking database to rebuild is linked (for active tracking databases. </td></tr>
<tr valign="top"><td><code>envir</code></td>
<td>
The tracked environment for which to rebuild the tracking database (for active tracking databases. </td></tr>
<tr valign="top"><td><code>dir</code></td>
<td>
The directory where the tracking database is stored (for tracking databases not currently active.</td></tr>
<tr valign="top"><td><code>fix</code></td>
<td>
If <code>TRUE</code>, try to fix various problems such as
illegal file names by renaming files or moving unusable
RData files to a 'quarantine' directory.  If <code>fix=TRUE</code> and
<code>dry.run=TRUE</code>, changes will be reported but not made.  </td></tr>
<tr valign="top"><td><code>level</code></td>
<td>
If <code>"missing"</code>, rebuild only missing information, if
<code>"all"</code>, rebuild information for all objects.</td></tr>
<tr valign="top"><td><code>trust</code></td>
<td>
When rebuilding an active tracking database, and there
are conflicts between the data in the environment versus that in
files, which should be trusted?</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
Controls number of messages about progress</td></tr>
<tr valign="top"><td><code>RDataSuffix</code></td>
<td>
What suffix should be used for RData files?
(Usually worked out automatically.)</td></tr>
<tr valign="top"><td><code>dry.run</code></td>
<td>
If <code>TRUE</code>, no data objects in R or files on disk
are changed: the return value is a list containing the rebuilt file map and
the rebuilt object summary.  If <code>FALSE</code>, objects in R
environments and files on disk can be changed.  The default is
<code>TRUE</code> to guard against changing things when it would have been
better not to have changed things, but this default may change in future.</td></tr>
<tr valign="top"><td><code>replace.wd</code></td>
<td>
If <code>TRUE</code>, file paths in diagnostic output are
printed starting with "./" where possible &ndash; this makes comparisons
of test output more portable.</td></tr>
<tr valign="top"><td><code>use.file.times</code></td>
<td>
If <code>TRUE</code>, file creation, modification and
access times are used for objects that were not found in
existing summary objects.  If <code>FALSE</code>, the current time is
used, which can be useful for testing purposes.</td></tr>
</table>

<h3>Details</h3>

<p>
The file map and/or the object summary are rebuilt.  If
<code>level=="all"</code>, all RData files will be read, which could take a
long time if there are many files.  If <code>level=="missing"</code>, RData
files will be read only where there is missing information.
</p>
<p>
If there are incompatible RData files in the directory (e.g., illegal
or duplicated object names, or multiple objects), <code>track.rebuild</code> will stop with an
error unless <code>fix==TRUE</code>, in which case the incompatible
RData files will either be renamed or moved to a <code>quarantine</code>
subdirectory.  In the case of duplicated object names, the second
object encountered will be moved.
</p>


<h3>Value</h3>

<p>
The value returned is a list with between two and four components:
</p>
<table summary="R argblock">
<tr valign="top"><td><code>fileMap</code></td>
<td>
The mapping from object names to files (excluding the suffix)</td></tr>
<tr valign="top"><td><code>summary</code></td>
<td>
The dataframe that summarizes objects</td></tr>
<tr valign="top"><td><code>unsaved</code></td>
<td>
(optional) The names of variables that are not saved to
disk.  This component is only present if it is non-empty.</td></tr>
<tr valign="top"><td><code>masked</code></td>
<td>
(optinal) The names of tracked variables that are masked
by other variables in the tracked environment.
This component is only present if it is non-empty.</td></tr>
</table>
<p>

The returned value is visible if <code>dry.run=TRUE</code> and invisible otherwise.</p>

<h3>Author(s)</h3>

<p>
Tony Plate &lt;tplate@acm.org&gt;
</p>


<h3>See Also</h3>

<p>
<a href="track.design.html">design</a> of the <code>trackObjs</code> package.
</p>


<h3>Examples</h3>

<pre>
# Rebuild a damaged tracking database
library(trackObjs)
unlink("tmp1", recursive=TRUE)
# build a tracking dir populated with some variables
track.start("tmp1")
track(x &lt;- 33)
track(X &lt;- array(1:24, dim=2:4))
track(Y &lt;- list(a=1:3,b=2))
X[2] &lt;- -1
track(abc &lt;- "def")
track(def &lt;- list(1,2,3))
invisible(Y); invisible(abc); invisible(abc); invisible(abc)
track.summary()
track.stop()
# damage the database (remove the filemap)
unlink("tmp1/filemap.txt")
# and rebuild
track.rebuild(dir="tmp1", verbose=2, dry.run=FALSE, fix=TRUE)
track.start("tmp1")
track.summary()
track.status()
track.stop()
unlink("tmp1", recursive=TRUE)
</pre>



<hr><div align="center">[Package <em>trackObjs</em> version 0.8-5 <a href="00Index.html">Index</a>]</div>

</body></html>
